# ðŸ“œ Automation & Helper Scripts

This directory contains helper scripts used for distributing and running the **jdkcerts** tool.

---

## 1. [jdkcerts](jdkcerts) (Launcher Script)

This Bash script acts as the entry point for the `jdkcertstool.jar`.

### Functionality

- **Dynamic Resolution**, via `brew --prefix`, of the `jdkcerts` installation directory and its `openjdk` dependency.

- **Execution Wrapper** to invokes the tool via Java:

  ```sh
  exec "$JAVA_BIN" -jar "$JAR_PATH" "$@"
    ```

  All user arguments (`"$@"`)â€”such as `install-cert` or `--help`â€”are passed through to the Kotlin application.

## 2. [generate_homebrew_formula.sh](generate_homebrew_formula.sh)

This Bash script is used in the [release.yml](../.github/workflows/release.yml) GitHub Actions workflow to generate the
Ruby code for [jdkcerts.rb](../Formula/jdkcerts.rb). It is meant to be used as part of
the  [release.yml](../.github/workflows/release.yml) because it requires to download the Jar associated with a GitHub Release!

### Usage

```bash
./scripts/generate_homebrew_formula.sh <TAG_VERSION>
```

### Functionality

- **Downloads** the `.jar` and the launcher script from the specified GitHub Release tag.

- **Verifies** the SHA256 hash of the downloaded files using `shasum`.

- **Generates** a Heredoc template to write the `jdkcerts.rb` file, injecting:
    - The new version string
    - The GitHub Release download URLs
    - The calculated SHA256 hashes

This ensures that the Homebrew formula always matches the exact byte-content of the release artifacts, preventing
installation errors due to hash mismatches.

### The Autogenerated Formula

The [jdkcerts.rb](../Formula/jdkcerts.rb) requires `openjdk` and is installed into a private `libexec` directory,
while the Launcher script (`jdkcerts`) is installed into `bin`, making it accessible in the user's `$PATH`.

#### Manual Testing

```sh
# Verify syntax and URLs
brew audit --strict ../Formula/jdkcerts.rb

# Install from the local formula
brew install --verbose --debug --build-from-source ../Formula/jdkcerts.rb

# Confirm the install works
jdkcerts --help
